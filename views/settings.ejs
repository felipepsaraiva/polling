<%- include('includes/header', { title: 'Settings' }) %>
<%- include('includes/navbar', { user: user }) %>

<main id="page-settings" class="container py-5">
  <div class="row justify-content-center my-3">
    <div class="col-md-8 col-lg-7 col-xl-6">
      <h1 class="text-center mb-5">Settings</h1>

      <section id="user-information">
        <div class="d-none alert alert-success text-center" role="alert">
          Information updated successfully!
        </div>

        <form>
          <div class="form-group" id="email">
            <label for="email-input"><strong>Email:</strong></label>
            <input type="text" id="email-input" class="form-control" value="<%= user.email %>">
            <div class="invalid-feedback"></div>
          </div>

          <div class="form-group" id="username">
            <label for="username-input"><strong>Username:</strong></label>
            <input type="text" id="username-input" class="form-control" value="<%= user.username %>">
            <div class="invalid-feedback"></div>
          </div>

          <button type="submit" class="btn btn-warning d-block mx-auto">
            <i class="fa fa-floppy-o"></i> Save
          </button>

          <button type="button" class="d-none btn btn-warning mx-auto">
            <i class="fa fa-spinner fa-pulse"></i> Saving...
          </button>
        </form>
      </section>

      <hr class="my-5">

      <section id="change-password">
        <div class="d-none alert alert-success text-center" role="alert">
          Password changed successfully!
        </div>

        <h5>Change Password:</h5>

        <form>
          <div class="form-group mb-1" id="current-password">
            <label for="current-password-input" class="sr-only">Current password:</label>
            <input type="password" id="current-password-input" class="form-control" placeholder="Current Password">
            <div class="invalid-feedback"></div>
          </div>

          <div class="form-group mb-1" id="password">
            <label for="password-input" class="sr-only">New password:</label>
            <input type="password" id="password-input" class="form-control" placeholder="New Password">
            <div class="invalid-feedback"></div>
          </div>

          <div class="form-group" id="rpassword">
            <label for="rpassword-input" class="sr-only">Repeat new password:</label>
            <input type="password" id="rpassword-input" class="form-control" placeholder="Repeat New Password">
            <div class="invalid-feedback"></div>
          </div>

          <button type="submit" class="btn btn-warning d-block mx-auto">
            <i class="fa fa-pencil-square-o"></i> Change password
          </button>

          <button type="button" class="d-none btn btn-warning mx-auto">
            <i class="fa fa-spinner fa-pulse"></i> Changing...
          </button>
        </form>
      </section>

      <hr class="my-5">

      <section id="danger-zone">
        <div class="row">
          <div class="col">
            <h5 class="text-danger"><strong>Danger Zone</strong></h5>
          </div>

          <div class="col">
            <button type="button" class="btn btn-danger btn-block" data-toggle="modal" data-target="#delete-account-modal">
              <i class="fa fa-trash-o"></i> Delete account
            </button>
          </div>
        </div>
      </section>
    </div>
  </div>
</main>

<div class="modal fade" id="delete-account-modal" tabindex="-1" role="dialog" aria-labelledby="delete-account-modal-title" aria-hidden="true">
  <div class="modal-dialog" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="delete-account-modal-title">Delete Account</h5>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body">
        <p>Your account and all the polls you created will be deleted forever, and this action <strong>can not be undone!</strong></p>
        <p class="mb-0">Confirm your decision by typing you username (<strong><%= user.username %></strong>) below:</p>

        <input type="text" id="delete-username" class="form-control form-control-sm">
        <input type="hidden" id="real-username" value="<%= user.username %>">

        <div class="d-none alert alert-danger text-center mt-4" role="alert">
          An error occurred on the server, please try again later.
        </div>
      </div>
      <div class="modal-footer">
        <button type="button" id="delete-action" class="btn btn-danger" disabled>Delete</button>
        <button type="button" class="d-none btn btn-danger" disabled>
          <i class="fa fa-spinner fa-pulse"></i> Deleting...
        </button>

        <button type="button" class="btn btn-secondary" data-dismiss="modal">Cancel</button>
      </div>
    </div>
  </div>
</div>

<%- include('includes/footer', { scripts: ['settings'] }) %>
